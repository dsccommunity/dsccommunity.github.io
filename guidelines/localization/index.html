<head>
  <meta charset="utf-8">
  <title>Localization</title>

  <meta name="generator" content="Hugo 0.57.0" />

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-144465379-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


  <!-- ** Plugins Needed for the Project ** -->
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://dsccommunity.org/plugins/bootstrap/bootstrap.min.css">
  <!-- themefy-icon -->
  <link rel="stylesheet" href="https://dsccommunity.org/plugins/themify-icons/themify-icons.css">
  <!-- highlight -->
  <link rel="stylesheet" href="https://dsccommunity.org/plugins/highlight/hybrid.css">
  <!-- fonts -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">


  <style>
  :root{
    --primary-color:#003366;
    --secondary-color:#f9f9f9;
    --text-color:#242738;
    --text-color-dark:#000;
    --white-color:#ffffff;
  }
  </style>

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://dsccommunity.org/css/style.min.css" integrity="" media="screen">

  <!-- jquiry -->
  <script src="https://dsccommunity.org/plugins/jquery/jquery-1.12.4.js"></script>

  <!-- jquary ui -->
  <script src="https://dsccommunity.org/plugins/jquery/jquery-ui.js"></script>

  <!--Favicon-->
  <link rel="icon" href="https://dsccommunity.org/images/favicon.png" type="image/x-icon">

</head>

<!-- navigation -->
<header class="shadow-bottom sticky-top bg-white">
  <div class="container">
    <nav class="navbar navbar-expand-lg navbar-light">
  <a class="navbar-brand" href="https://dsccommunity.org/">DSC Community and Resource Kit</a>
  <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation"
    aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse text-center" id="navigation">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a class="nav-link text-dark" href="https://dsccommunity.org/">Home</a>
      </li>
      
      
      <li class="nav-item">
          <a class="nav-link text-dark" href="/code_of_conduct">Code of Conduct</a>
      </li>
      
      
      
      <li class="nav-item">
          <a class="nav-link text-dark" href="/community_calls">Community Calls</a>
      </li>
      
      
      
      <li class="nav-item">
          <a class="nav-link text-dark" href="/faq">Faq</a>
      </li>
      
      
      
      <li class="nav-item">
          <a class="nav-link text-dark" href="/help">help</a>
      </li>
      
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
          aria-expanded="false">
          Categories
        </a>
        <div class="dropdown-menu" >
          
          <a class="dropdown-item" href="/community">Community</a>
          
          <a class="dropdown-item" href="/resources">Resource Modules</a>
          
          <a class="dropdown-item" href="/guidelines">Guidelines</a>
          
          <a class="dropdown-item" href="/blog">Blog Posts</a>
          
          <a class="dropdown-item" href="/configmgt">Config. Management</a>
          
        </div>
      </li>
      
      
    </ul>
    
    <ul class="list-inline text-center mb-0">
      
    </ul>
  </div>
</nav>
  </div>
</header>
<!-- /navigation -->


<section class="single pt-5 bg-gray">
  <div class="container-fluid">
    <div class="row">
      <div class="col-lg-3">
        <div class="p-4 bg-white sticky-top top-100">
            
            <nav class="sidebar-menu">
              <ul class="list-styled">
            <li class=""><a href="/community/">Community</a>
              <ul class="">
            <li class=""><a href="/community/origin-story/">Origin Story</a>
            </li>
            <li class=""><a href="/community/ownership/">Ownership of DSC Resources</a>
            </li>
            <li class=""><a href="/community/committee/">DSC Community Committee</a>
            </li>
            <li class=""><a href="/community/maintainers/">Maintainers</a>
            </li>
            <li class=""><a href="/community/contact/">Join the Conversation</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/resources/">Resource Modules</a>
            </li>
            <li class="parent d-block "><a href="/guidelines/">Guidelines</a>
              <ul class="sub-menu">
            <li class=""><a href="/guidelines/markdown-files/">Markdown Files</a>
            </li>
            <li class=""><a href="/guidelines/general/">General</a>
            </li>
            <li class=""><a href="/guidelines/whitespace/">Whitespace</a>
            </li>
            <li class=""><a href="/guidelines/functions/">Functions</a>
            </li>
            <li class=""><a href="/guidelines/parameters/">Parameters</a>
            </li>
            <li class=""><a href="/guidelines/variables/">Variables</a>
            </li>
            <li class=""><a href="/guidelines/general-best-practices/">General Best Practices</a>
            </li>
            <li class=""><a href="/guidelines/calling-functions/">Calling Functions</a>
            </li>
            <li class=""><a href="/guidelines/writing-functions/">Writing Functions</a>
            </li>
            <li class=""><a href="/guidelines/dsc-resource-functions/">Dsc Resource Functions</a>
            </li>
            <li class=""><a href="/guidelines/manifest/">Manifest</a>
            </li>
            <li class=" active "><a href="/guidelines/localization/">Localization</a>
            </li>
            <li class=""><a href="/guidelines/pester-tests/">Pester Tests</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/blog/">Blog Posts</a>
              <ul class="">
            <li class=""><a href="/blog/create-an-article/">Create an Article</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/configmgt/">Configuration Management</a>
              <ul class="">
            <li class=""><a href="/configmgt/future-of-config-mgt/">Future of Configuration Management</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/community_calls/">Community Calls</a>
              <ul class="">
            <li class=""><a href="/community_calls/next_call/">Next Community Call 2019-09-11</a>
            </li>
            <li class=""><a href="/community_calls/2019-07-31-notes/">2019-07-31 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2019-06-19-notes/">2019-06-19 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2019-05-08-notes/">2019-05-08 Notes</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/code_of_conduct/">Code of Conduct</a>
              <ul class="">
            <li class=""><a href="/code_of_conduct/standards/">Our Standards</a>
            </li>
            <li class=""><a href="/code_of_conduct/responsibilities/">Our Responsibilities</a>
            </li>
            <li class=""><a href="/code_of_conduct/scope/">Scope</a>
            </li>
            <li class=""><a href="/code_of_conduct/enforcement/">Enforcement</a>
            </li>
            <li class=""><a href="/code_of_conduct/common_questions/">Common Questions</a>
            </li>
            <li class=""><a href="/code_of_conduct/attribution/">Attribution</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/help/">Help</a>
              <ul class="">
            <li class=""><a href="/help/what-is-dsc/">What is Desired State Configuration</a>
            </li>
            <li class=""><a href="/help/what-future-for-dsc/">What Future for Dsc</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/contributors/">Elements</a>
            </li>
            <li class=""><a href="/faq/">Frequently Asked Questions</a>
            </li></ul>
            </nav>

            
        </div>
      </div>
      <div class="col-lg-9">
        <div class="p-5 bg-white">
            <h2>Localization</h2>
            

<p>In each resource folder there should be at least one localization folder for
english language &lsquo;en-US&rsquo;. Add other localization folders as appropriate, the
correct folder name can be found by running <code>Get-UICulture</code> on the node that
has a UI culture installed that the strings are being built for.
There is also the list of
<a href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/available-language-packs-for-windows#language-packs">Available Language Packs for Windows</a>.</p>

<p>In each localization folder there should be a PowerShell data (.psd1) file named
&lsquo;MSFT_&lt;ResourceName&gt;.strings.psd1&rsquo; (e.g. &lsquo;MSFT_Folder.strings.psd1&rsquo;).
Each localized string file should contain the following with the correct
localization key and accompanying localization string value (the example uses
the friendly resource name of &lsquo;Folder&rsquo;).</p>

<pre><code class="language-powershell"># Localized resources for Folder

ConvertFrom-StringData @'
    CreateFolder = Creating folder at path '{0}'. (F0001)
    RetrievingFolderInformation = Retrieving folder information from path '{0}'. (F0002)
    ProblemAccessFolder = Could not access the requested path '{0}'. (F0003)
    FailedToReadProperties = Could not read property '{0}' of path '{1}'. (F0004)
'@
</code></pre>

<p>When using the previous example, the folder structure would look like the
following:</p>

<pre><code class="language-plaintext">DSCResources\MSFT_Folder\en-US\MSFT_Folder.strings.psd1
DSCResources\MSFT_Folder\es-ES\MSFT_Folder.strings.psd1
</code></pre>

<p>To use the localization strings in a resource, then localization strings are
imported at the top of each resource PowerShell module script file (.psm1). The
localized strings should be imported using <a href="#get-localizeddata"><code>Get-LocalizedData</code></a>.</p>

<h2 id="localization-string-id-suffix">Localization string ID suffix</h2>

<p>To easier debug localized verbose logs, and to find the correct localized string
key in the code, it is recommended to use a hard coded ID on each localized key&rsquo;s
string value. That ID must be the same across the localized language files,
and it is not recommended to reuse ID&rsquo;s once they become obsolete (because of
for example code change).</p>

<blockquote>
<p>Using this method we could also test that each localized string is
represented in each language specific localization file for that
resource.</p>
</blockquote>

<p><strong>Format:</strong> <code>(ID:yyyyZZZZ)</code></p>

<ul>
<li>&lsquo;yyyy&rsquo; - The resource name prefix. It is composed of every first letter of
every word in the resource friendly name.</li>
<li>&lsquo;ZZZZ&rsquo; - The suffix is a serial number starting from &lsquo;0001&rsquo;.</li>
</ul>

<p><strong>Example of prefixes:</strong></p>

<table>
<thead>
<tr>
<th>Module</th>
<th>Resource</th>
<th>ID prefix (yyyy)</th>
<th>First string ID suffix</th>
</tr>
</thead>

<tbody>
<tr>
<td>PSDscResources</td>
<td>GroupResource</td>
<td>GR</td>
<td><code>(GR0001)</code></td>
</tr>

<tr>
<td>PSDscResources</td>
<td>WindowsOptionalFeature</td>
<td>WOF</td>
<td><code>(WOF0001)</code></td>
</tr>

<tr>
<td>SqlServerDsc</td>
<td>SqlSetup</td>
<td>SS</td>
<td><code>(SS0001)</code></td>
</tr>

<tr>
<td>SqlServerDsc</td>
<td>SqlAGDatabase</td>
<td>SAGD</td>
<td><code>(SAGD0001)</code></td>
</tr>

<tr>
<td>NetworkingDsc</td>
<td>DnsClientGlobalSetting</td>
<td>DCGS</td>
<td><code>(DCGS0001)</code></td>
</tr>

<tr>
<td>NetworkingDsc</td>
<td>Firewall</td>
<td>F</td>
<td><code>(F0001)</code></td>
</tr>

<tr>
<td>CertificateDsc</td>
<td>PfxImport</td>
<td>PI</td>
<td><code>(PI0001)</code></td>
</tr>

<tr>
<td>CertificateDsc</td>
<td>WaitForCertificateServices</td>
<td>WFCS</td>
<td><code>(WFCS0001)</code></td>
</tr>
</tbody>
</table>

<p><strong>Example of usage:</strong></p>

<p>See example of localized strings under <a href="#localization">Localization</a>.</p>

<h2 id="using-localization-string-in-code">Using localization string in code</h2>

<p>This is an example of how to write localized verbose messages.</p>

<pre><code class="language-powershell">Write-Verbose -Message `
    ($script:localizedData.RetrievingFolderInformation -f $path)
</code></pre>

<p>This is an example of how to write localized warning messages.</p>

<pre><code class="language-powershell">Write-Warning -Message `
    ($script:localizedData.ProblemAccessFolder -f $path)
</code></pre>

<p>This is an example of how to throw localized error messages, but the
<a href="#helper-functions-for-localization">helper functions</a>
<a href="#new-invalidargumentexception"><code>New-InvalidArgumentException</code></a>,
<a href="#new-invalidoperationexception"><code>New-InvalidOperationException</code></a>,
<a href="#new-objectnotfoundexception"><code>New-ObjectNotFoundException</code></a> and
<a href="#new-invalidresultexception"><code>New-InvalidResultException</code></a>
should preferably be used whenever possible.</p>

<pre><code class="language-powershell">throw ($script:localizedData.FailedToReadProperties -f $property, $path)
</code></pre>

<h3 id="helper-functions-for-localization">Helper functions for localization</h3>

<p>There are also five helper functions to simplify localization. These can be
be found in the repository <a href="https://github.com/PowerShell/DscResource.Template">DscResource.Template</a>
in the module script file <a href="https://github.com/PowerShell/DscResource.Template/blob/master/Modules/DscResource.LocalizationHelper/DscResource.LocalizationHelper.psm1">DscResource.LocalizationHelper</a></p>

<p>To use it, copy the module folder
<a href="https://github.com/PowerShell/DscResource.Template/blob/master/Modules/DscResource.LocalizationHelper">DscResource.LocalizationHelper</a>
and the unit tests
<a href="https://github.com/PowerShell/DscResource.Template/blob/master/Tests/Unit/DscResource.LocalizationHelper.Tests.ps1">DscResource.LocalizationHelper.Tests.ps1</a>
to the new resource module.</p>

<h4 id="get-localizeddata">Get-LocalizedData</h4>

<p>This should be used at the top of each resource PowerShell module script file
(.psm1).
Refer to the comment-based help for more information about this helper function.</p>

<pre><code class="language-powershell">$script:resourceModulePath = Split-Path `
    -Path (Split-Path -Path $PSScriptRoot -Parent) `
    -Parent

$script:localizationModulePath = Join-Path `
    -Path $script:resourceModulePath `
    -ChildPath 'Modules\DscResource.LocalizationHelper'

Import-Module -Name (
    Join-Path `
        -Path $script:localizationModulePath `
        -ChildPath 'DscResource.LocalizationHelper.psm1'
    )

$script:localizedData = Get-LocalizedData -ResourceName 'MSFT_SqlSetup'
</code></pre>

<h4 id="new-invalidargumentexception">New-InvalidArgumentException</h4>

<p>Refer to the comment-based help for more information about this helper function.</p>

<pre><code class="language-powershell">if ( -not $resultOfEvaluation )
{
    $errorMessage = `
        $script:localizedData.ActionCannotBeUsedInThisContextMessage `
            -f $Action, $Parameter

    New-InvalidArgumentException -ArgumentName 'Action' -Message $errorMessage
}
</code></pre>

<h4 id="new-invalidoperationexception">New-InvalidOperationException</h4>

<p>Refer to the comment-based help for more information about this helper function.</p>

<pre><code class="language-powershell">try
{
    Start-Process @startProcessArguments
}
catch
{
    $errorMessage = $script:localizedData.InstallationFailedMessage -f $Path, $processId
    New-InvalidOperationException -Message $errorMessage -ErrorRecord $_
}

</code></pre>

<h4 id="new-objectnotfoundexception">New-ObjectNotFoundException</h4>

<p>Refer to the comment-based help for more information about this helper function.</p>

<pre><code class="language-powershell">try
{
    Get-ChildItem -Path $path
}
catch
{
    $errorMessage = $script:localizedData.PathNotFoundMessage -f $path
    New-ObjectNotFoundException -Message $errorMessage -ErrorRecord $_
}

</code></pre>

<h4 id="new-invalidresultexception">New-InvalidResultException</h4>

<p>Refer to the comment-based help for more information about this helper function.</p>

<pre><code class="language-powershell">try
{
    $numberOfObjects = Get-ChildItem -Path $path
    if ($numberOfObjects -eq 0)
    {
        throw 'To few files.'
    }
}
catch
{
    $errorMessage = $script:localizedData.TooFewFilesMessage -f $path
    New-InvalidResultException -Message $errorMessage -ErrorRecord $_
}

</code></pre>

            <p class="post-meta border-bottom pb-3 mb-0">Updated on 28 Jan 2019</p><nav class="pagination mt-3"><a class="nav nav-prev" href="/guidelines/manifest/" title="Manifest"><i class="ti-arrow-left mr-2"></i>Manifest</a>
            <a class="nav nav-next" href="/guidelines/pester-tests/" title="Pester Tests">Pester Tests<i class="ti-arrow-right ml-2"></i></a>
            </nav></div>
      </div>
    </div>
  </div>
</section>


<!-- footer -->
<footer class="section bg-gray pb-0">
  <div class="container">
    <div class="row">
      <div class="col-md-8 text-md-left text-center">
        <p>Copyright 2019 the dsccommunity.org contributors.</p> 
      </div>
      <div class="col-md-4 text-md-right text-center">
        <ul class="list-inline mb-3">
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://github.com/dsccommunity/"><i class="ti-github"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://twitter.com/dsccommunity"><i class="ti-twitter-alt"></i></a></li>
          
        </ul>
      </div>
    </div>
  </div>
</footer>
<!-- /footer -->

<!-- Bootstrap JS -->
<script src="https://dsccommunity.org/plugins/bootstrap/bootstrap.min.js"></script>
<!-- highlight -->
<script src="https://dsccommunity.org/plugins/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<!-- Main Script -->

<script src="https://dsccommunity.org/js/script.min.js"></script>