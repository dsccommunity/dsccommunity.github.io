<head>
  <meta charset="utf-8">
  <title>DscResource.Common functions in a DSC module</title>

  <meta name="generator" content="Hugo 0.75.1" />

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-144465379-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


  <!-- ** Plugins Needed for the Project ** -->
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://dsccommunity.org/plugins/bootstrap/bootstrap.min.css">
  <!-- themefy-icon -->
  <link rel="stylesheet" href="https://dsccommunity.org/plugins/themify-icons/themify-icons.css">
  <!-- highlight -->
  <link rel="stylesheet" href="https://dsccommunity.org/plugins/highlight/hybrid.css">
  <!-- fonts -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">


  <style>
  :root{
    --primary-color:#003366;
    --secondary-color:#f9f9f9;
    --text-color:#242738;
    --text-color-dark:#000;
    --white-color:#ffffff;
  }
  </style>

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://dsccommunity.org/css/style.min.css" integrity="" media="screen">

  <!-- jquiry -->
  <script src="https://dsccommunity.org/plugins/jquery/jquery-1.12.4.js"></script>

  <!-- jquary ui -->
  <script src="https://dsccommunity.org/plugins/jquery/jquery-ui.js"></script>

  <!--Favicon-->
  <link rel="icon" href="https://dsccommunity.org/images/favicon.png" type="image/x-icon">

</head>

<!-- navigation -->
<header class="shadow-bottom sticky-top bg-white">
  <div class="container">
    <nav class="navbar navbar-expand-lg navbar-light">
  <a class="navbar-brand" href="https://dsccommunity.org/">DSC Community and Resource Kit</a>
  <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation"
    aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse text-center" id="navigation">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a class="nav-link text-dark" href="https://dsccommunity.org/">Home</a>
      </li>
      
      
      <li class="nav-item">
          <a class="nav-link text-dark" href="/code_of_conduct">Code of Conduct</a>
      </li>
      
      
      
      <li class="nav-item">
          <a class="nav-link text-dark" href="/community_calls">Community Calls</a>
      </li>
      
      
      
      <li class="nav-item">
          <a class="nav-link text-dark" href="/faq">Faq</a>
      </li>
      
      
      
      <li class="nav-item">
          <a class="nav-link text-dark" href="/help">help</a>
      </li>
      
      
      
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
          aria-expanded="false">
          Categories
        </a>
        <div class="dropdown-menu" >
          
          <a class="dropdown-item" href="/community">Community</a>
          
          <a class="dropdown-item" href="/resources">Resource Modules</a>
          
          <a class="dropdown-item" href="/guidelines">Guidelines</a>
          
          <a class="dropdown-item" href="/blog">Blog Posts</a>
          
          <a class="dropdown-item" href="/configmgt">Config. Management</a>
          
        </div>
      </li>
      
      
    </ul>
    
    <ul class="list-inline text-center mb-0">
      
    </ul>
  </div>
</nav>
  </div>
</header>
<!-- /navigation -->


<section class="single pt-5 bg-gray">
  <div class="container">
    <div class="row">
      <div class="col-lg-3">
        <div class="p-4 bg-white sticky-top top-100">
            
            <nav class="sidebar-menu">
              <ul class="list-styled">
            <li class=""><a href="/community/">Community</a>
              <ul class="">
            <li class=""><a href="/community/origin-story/">Origin Story</a>
            </li>
            <li class=""><a href="/community/ownership/">Ownership of DSC Resources</a>
            </li>
            <li class=""><a href="/community/committee/">DSC Community Committee</a>
            </li>
            <li class=""><a href="/community/maintainers/">Maintainers</a>
            </li>
            <li class=""><a href="/community/contact/">Join the Conversation</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/resources/">Resource Modules</a>
            </li>
            <li class=""><a href="/guidelines/">Guidelines</a>
              <ul class="">
            <li class=""><a href="/guidelines/getting-started/">Getting Started as a Contributor</a>
            </li>
            <li class=""><a href="/guidelines/contributing/">Contributing</a>
            </li>
            <li class=""><a href="/guidelines/maintaining/">Maintaining</a>
            </li>
            <li class=""><a href="/guidelines/style-guidelines/">Style Guidelines</a>
            </li>
            <li class=""><a href="/guidelines/testing-guidelines/">Testing Guidelines</a>
            </li>
            <li class=""><a href="/guidelines/administration/">Administration</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/styleguidelines/">Style Guidelines</a>
              <ul class="">
            <li class=""><a href="/styleguidelines/markdown-files/">Markdown Files</a>
            </li>
            <li class=""><a href="/styleguidelines/general/">General</a>
            </li>
            <li class=""><a href="/styleguidelines/whitespace/">Whitespace</a>
            </li>
            <li class=""><a href="/styleguidelines/functions/">Functions</a>
            </li>
            <li class=""><a href="/styleguidelines/parameters/">Parameters</a>
            </li>
            <li class=""><a href="/styleguidelines/variables/">Variables</a>
            </li>
            <li class=""><a href="/styleguidelines/general-best-practices/">General Best Practices</a>
            </li>
            <li class=""><a href="/styleguidelines/calling-functions/">Calling Functions</a>
            </li>
            <li class=""><a href="/styleguidelines/writing-functions/">Writing Functions</a>
            </li>
            <li class=""><a href="/styleguidelines/dsc-resource-functions/">Dsc Resource Functions</a>
            </li>
            <li class=""><a href="/styleguidelines/manifest/">Manifest</a>
            </li>
            <li class=""><a href="/styleguidelines/localization/">Localization</a>
            </li>
            <li class=""><a href="/styleguidelines/pester-tests/">Pester Tests</a>
            </li></ul>
              
            </li>
            <li class="parent d-block "><a href="/blog/">Blog Posts</a>
              <ul class="sub-menu">
            <li class=""><a href="/blog/create-an-article/">Create an Article</a>
            </li>
            <li class=""><a href="/blog/dsc-is-dead-long-live-dsc/">DSC is Dead</a>
            </li>
            <li class=""><a href="/blog/class-based-dsc-resources/">Class Based DSC Resource only proposal</a>
            </li>
            <li class=""><a href="/blog/converting-tests-to-pester5/">Converting tests to Pester 5</a>
            </li>
            <li class=""><a href="/blog/add-codecov-support-to-repository/">Add Codecov Support to Repository</a>
            </li>
            <li class="parent d-block  active "><a href="/blog/use-dscresource-common-functions-in-module/">DscResource.Common functions in a DSC module</a>
            </li>
            <li class=""><a href="/blog/convert-a-module-for-continuous-delivery/">Steps to convert a module for continuous delivery</a>
            </li>
            <li class=""><a href="/blog/how-to-use-dsc-logging/">How to Use Dsc Logging</a>
            </li>
            <li class=""><a href="/blog/dsc-maintenance-windows/">Realizing maintenance windows with DSC</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/configmgt/">Configuration Management</a>
              <ul class="">
            <li class=""><a href="/configmgt/future-of-config-mgt/">Future of Configuration Management</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/community_calls/">Community Calls</a>
              <ul class="">
            <li class=""><a href="/community_calls/next_call/">Next Community Call 2020-09-23</a>
            </li>
            <li class=""><a href="/community_calls/2020-08-12-notes/">2020-08-12 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2020-07-01-notes/">2020-07-01 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2020-05-20-notes/">2020-05-20 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2020-04-08-notes/">2020-04-08 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2020-02-26-notes/">2020-02-26 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2020-01-22-notes/">2020-01-22 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2019-12-04-notes/">2019-12-04 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2019-10-23-notes/">2019-10-23 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2019-09-11-notes/">2019-09-11 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2019-07-31-notes/">2019-07-31 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2019-06-19-notes/">2019-06-19 Notes</a>
            </li>
            <li class=""><a href="/community_calls/2019-05-08-notes/">2019-05-08 Notes</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/code_of_conduct/">Code of Conduct</a>
              <ul class="">
            <li class=""><a href="/code_of_conduct/standards/">Our Standards</a>
            </li>
            <li class=""><a href="/code_of_conduct/responsibilities/">Our Responsibilities</a>
            </li>
            <li class=""><a href="/code_of_conduct/scope/">Scope</a>
            </li>
            <li class=""><a href="/code_of_conduct/enforcement/">Enforcement</a>
            </li>
            <li class=""><a href="/code_of_conduct/common_questions/">Common Questions</a>
            </li>
            <li class=""><a href="/code_of_conduct/attribution/">Attribution</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/help/">Help</a>
              <ul class="">
            <li class=""><a href="/help/what-is-dsc/">What is Desired State Configuration</a>
            </li>
            <li class=""><a href="/help/what-future-for-dsc/">What Future for Dsc</a>
            </li></ul>
              
            </li>
            <li class=""><a href="/contributors/">Elements</a>
            </li>
            <li class=""><a href="/faq/">Frequently Asked Questions</a>
            </li></ul>
            </nav>

            
        </div>
      </div>
      <div class="col-lg-9">
        <div class="p-5 bg-white">
            <h2>DscResource.Common functions in a DSC module</h2>
            <h3 id="what">What</h3>
<p>This article will explain the steps needed to use a version of the
<a href="https://github.com/dsccommunity/DscResource.Common">DscResource.Common</a>
module that has been released to the <a href="https://www.powershellgallery.com/packages/DscResource.Common">PowerShell Gallery</a>.</p>
<p>The module DscResource.Common currently has <a href="https://github.com/dsccommunity/DscResource.Common#cmdlet">7 cmdlets</a>.</p>
<ul>
<li><code>Get-LocalizedData</code></li>
<li><code>New-InvalidArgumentException</code></li>
<li><code>New-InvalidOperationException</code></li>
<li><code>New-NotImplementedException</code></li>
<li><code>New-InvalidResultException</code></li>
<li><code>New-ObjectNotFoundException</code></li>
<li><code>Test-DscParameterState</code></li>
</ul>
<h3 id="why">Why</h3>
<p>Historically, these functions have been duplicated into many DSC resource
modules. This has resulted in duplication of effort in maintaining them as
well as drift in the code base and feature set with some fixes not being
included. or the same changes. Instead of re-invent the wheel for these
functions, the community can contribute to these functions in one location
that then can be reused by all DSC module repositories.</p>
<h3 id="how">How</h3>
<h4 id="prerequisites">Prerequisites</h4>
<p>It is assumed that the DSC module repository is already using
the DSC module Plaster template in the <a href="https://github.com/gaelcolas/Sampler">Sampler</a>
project, or has been converted to use the new CI pipeline using the steps
mentioned in <a href="/blog/convert-a-module-for-continuous-delivery/">Steps to convert a module for continuous delivery</a></p>
<h4 id="update-file-requiredmoduledpsd1">Update file <code>RequiredModuled.psd1</code></h4>
<p>Add a new entry to the file <code>RequiredModuled.psd1</code> letting the CI pipeline
know which module and version to download. You should pin the version here
so that breaking changes in the upstream does not affect you.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">@{
    <span style="color:#75715e"># ...Previous required modules...</span>

    <span style="color:#75715e"># Build dependent modules</span>
    <span style="color:#e6db74">&#39;DscResource.Common&#39;</span> = <span style="color:#e6db74">&#39;0.2.0&#39;</span>
}
</code></pre></div><p>Then resolve CI pipeline dependencies.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">./build.ps1 -ResolveDependency -task noop
</code></pre></div><h4 id="update-file-buildyaml">Update file <code>Build.yaml</code></h4>
<h5 id="add-a-nested-module">Add a nested module</h5>
<p>You should add a nested module configuration to the file <code>build.yaml</code>
so that the module is copied from the folder <code>output/RequiredModules</code>
at build time. Important to note here that we are not adding it as a
nested module in the module manifest, it will just copy the module to
the folder <code>Modules</code> (which is the default for <a href="https://github.com/PoshCode/ModuleBuilder">ModuleBuilder</a>).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e">####################################################</span>
<span style="color:#75715e">#   ModuleBuilder Dependent Modules Configuration  #</span>
<span style="color:#75715e">####################################################</span>

<span style="color:#f92672">NestedModule</span>:
  <span style="color:#f92672">DscResource.Common</span>:
    <span style="color:#f92672">CopyOnly</span>: <span style="color:#66d9ef">true</span>
    <span style="color:#f92672">Path</span>: <span style="color:#ae81ff">./output/RequiredModules/DscResource.Common</span>
    <span style="color:#f92672">AddToManifest</span>: <span style="color:#66d9ef">false</span>
    <span style="color:#f92672">Exclude</span>: <span style="color:#ae81ff">PSGetModuleInfo.xml</span>
</code></pre></div><h5 id="exclude-nested-module-from-tests">Exclude nested module from tests</h5>
<p>Next, you need to exclude this module from the CI pipeline tests phase.
The module has already been tested in its own CI pipeline so no need
for you to test that again. It might also be that the repository has
different quality assurances that DscResource.Common does not (like
naming files differently).</p>
<p>Under the key <code>Pester:</code> add an exclude from code coverage.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">Pester</span>:
  <span style="color:#f92672">ExcludeFromCodeCoverage</span>:
    - <span style="color:#ae81ff">Modules/DscResource.Common</span>
</code></pre></div><p>Under the key <code>DscTest:</code> add an exclude to not run HQRM tests on the module
files.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">DscTest</span>:
  <span style="color:#f92672">ExcludeModuleFile</span>:
    - <span style="color:#ae81ff">Modules/DscResource.Common</span>
</code></pre></div><h4 id="update-dsc-resource-module-file">Update DSC resource module file</h4>
<p>For each DSC resource module file that should use a helper function in
the module DscResource.Common you must import the module.</p>
<p>You import the module&rsquo;s folder, not the file <code>.psd1</code> or <code>.psm1</code>.
The built in functionality of <code>Import-Module</code> is used to find the module
manifest. The module is copied using the version number folder
structure, and adding a absolut path to it here would break when you update
to a newer version of the module <code>DscResource.Common</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$script:resourceHelperModulePath = Join-Path -Path $PSScriptRoot -ChildPath <span style="color:#e6db74">&#39;..\..\Modules\DscResource.Common&#39;</span>

Import-Module -Name $script:resourceHelperModulePath
</code></pre></div><h4 id="use-the-common-functions">Use the common functions</h4>
<p>An example of using the common functions is to import localized strings
using <code>Get-LocalizedData</code>.</p>
<p>To import the localized strings for the resource add the code below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$script:localizedData = Get-LocalizedData -DefaultUICulture <span style="color:#e6db74">&#39;en-US&#39;</span>
</code></pre></div><p>To further see how to use localization see the
<a href="/styleguidelines/localization/">Localization section of the style guidelines</a>
and to see how to use the common functions see the documentation in the
<a href="https://github.com/dsccommunity/DscResource.Common">DscResource.Common repository</a>.</p>

            <p class="post-meta border-bottom pb-3 mb-0">Updated on 11 Jan 2020</p><nav class="pagination mt-3"><a class="nav nav-prev" href="/blog/add-codecov-support-to-repository/" title="Add Codecov Support to Repository"><i class="ti-arrow-left mr-2"></i>Add Codecov Support to Repository</a>
            <a class="nav nav-next" href="/blog/convert-a-module-for-continuous-delivery/" title="Steps to convert a module for continuous delivery">Steps to convert a module for continuous delivery<i class="ti-arrow-right ml-2"></i></a>
            </nav></div>
      </div>
    </div>
  </div>
</section>


<!-- footer -->
<footer class="section bg-gray pb-0">
  <div class="container">
    <div class="row">
      <div class="col-md-8 text-md-left text-center">
        <p>Copyright 2019 the dsccommunity.org contributors.</p> 
      </div>
      <div class="col-md-4 text-md-right text-center">
        <ul class="list-inline mb-3">
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://github.com/dsccommunity/"><i class="ti-github"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://twitter.com/dsccommunity"><i class="ti-twitter-alt"></i></a></li>
          
        </ul>
      </div>
    </div>
  </div>
</footer>
<!-- /footer -->

<!-- Bootstrap JS -->
<script src="https://dsccommunity.org/plugins/bootstrap/bootstrap.min.js"></script>
<!-- highlight -->
<script src="https://dsccommunity.org/plugins/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<!-- Main Script -->

<script src="https://dsccommunity.org/js/script.min.js"></script>